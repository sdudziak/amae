"use strict";function docReady(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}docReady(function(){let e=document.querySelectorAll(".castos-player");e.forEach(function(t){let s=t.dataset.player_id,n=window["ssp_castos_player_"+s],i=t.dataset.episode,e=t.querySelector(".ssp-playback"),r,a=t.querySelector(".play-btn"),o=t.querySelector(".pause-btn"),c=t.querySelector(".player__artwork"),l=t.querySelector(".ssp-duration"),d=t.querySelector(".ssp-timer"),u=t.querySelector(".ssp-progress"),p=t.querySelector(".progress__filled"),f=e.querySelectorAll("[data-skip]"),y=t.querySelector(".player-btn__volume"),v=t.querySelector(".player-btn__speed"),m=t.querySelector(".ssp-loader"),L=t.querySelector(".playlist__items"),_=t.querySelector(".player__podcast-title"),h=t.querySelector(".player__episode-title"),E=t.querySelector(".playlist__wrapper"),S=!!E,q,b;function k(e){return(""+(e+100)).substring(1)}function g(e){var t=Math.floor(e/3600);e%=3600;let i=Math.floor(e/60),r=Math.floor(e%60),s=0;return s=0<t?k(t)+" : "+k(i)+" : "+k(r):k(i)+":"+k(r),s}function T(){clearTimeout(b),b=setTimeout(function(){r.paused?(r.play(),w(),o.focus()):(M(),a.focus())},100)}function M(){r.pause(),w()}function w(){r.paused?(o.classList.add("hide"),a.classList.remove("hide"),a.setAttribute("aria-pressed","false"),o.setAttribute("aria-pressed","true")):(o.classList.remove("hide"),a.classList.add("hide"),a.setAttribute("aria-pressed","true"),o.setAttribute("aria-pressed","false"))}function x(){l.innerHTML=g(r.duration),l.setAttribute("datetime",function(e){var t=Math.floor(e/3600),i=Math.floor(e%3600/60),e=Math.floor(e%60);let r="PT";0<t&&(r+=t+"H");(0<i||0<t)&&(r+=i+"M");return r+=e+"S",r}(r.duration)),u.setAttribute("aria-valuemax",Math.floor(r.duration))}function A(){var e=r.currentTime/r.duration*100;p.style.flexBasis=e+"%",d.innerHTML=g(r.currentTime),u.setAttribute("aria-valuenow",Math.floor(r.currentTime))}function C(e){r.currentTime=e.offsetX/u.offsetWidth*r.duration}function H(){r.currentTime+=parseFloat(this.dataset.skip)}function F(e){(e<.4||2<e)&&(e=1),v.setAttribute("data-speed",e),v.innerHTML=e+"x",r.playbackRate=e}function R(){m.classList.remove("hide")}function D(){m.classList.add("hide")}function O(){D(),r=t.querySelector(".clip-"+i),r.addEventListener("play",w),r.addEventListener("pause",w),r.addEventListener("playing",w),r.addEventListener("playing",x),r.addEventListener("timeupdate",A),r.onended=function(){o.classList.add("hide"),a.classList.remove("hide");let e=t.querySelector(".playlist__item.active");if(e){e.classList.remove("active");let t=e.nextElementSibling;if(t){let e=document.createEvent("HTMLEvents");e.initEvent("click",!0,!1),t.dispatchEvent(e)}}},r.addEventListener("waiting",R),r.addEventListener("canplay",D)}a.addEventListener("click",T),o.addEventListener("click",T),c.addEventListener("click",T),v.addEventListener("click",function(){F(this.dataset.speed<2?(parseFloat(this.dataset.speed)+.2).toFixed(1):.4)}),f.forEach(function(e){return e.addEventListener("click",H)}),y.addEventListener("click",function(){1===r.volume?(r.volume=0,y.classList.add("off")):(r.volume=1,y.classList.remove("off"))});let j=!1;u.addEventListener("click",C),u.addEventListener("mousemove",function(e){return j&&C(e)}),u.addEventListener("mousedown",function(){return j=!0}),u.addEventListener("mouseup",function(){return j=!1});let K=t.querySelector(".subscribe-btn"),P=t.querySelector(".player-panels .subscribe"),J=t.querySelector(".player-panels .subscribe .close-btn"),N=t.querySelector(".share-btn"),W=t.querySelector(".player-panels .share"),X=t.querySelector(".player-panels .share .close-btn"),B=t.querySelector(".input-link"),G=t.querySelector(".copy-link"),U=t.querySelector(".input-embed"),z=t.querySelector(".copy-embed"),I=t.querySelector(".input-rss"),Q=t.querySelector(".copy-rss");function V(e){e.classList.contains("open")?e.classList.remove("open"):(e.classList.add("open"),e.focus())}function Y(e){e.select(),document.execCommand("Copy")}function Z(){var e,t;this.dataset.episode!==i&&(L.querySelectorAll(".playlist__item").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),e=this.querySelector(".playlist__episode-title"),t=this.querySelector(".playlist__item__cover img"),_.textContent=e.dataset.podcast,h.textContent=e.textContent,c.querySelector("img").src=t.src,M(),i=this.dataset.episode,O(),setTimeout(function(){T()},500))}function $(){function r(){q.style.display="none",E.dataset.processing=""}E.dataset.processing||q.scrollHeight-q.scrollTop!==q.clientHeight||function(){q.style.display="block",E.dataset.processing="1";let e=new XMLHttpRequest,t=new URL(n.ajax_url);var i={action:"get_playlist_items",atts:JSON.stringify(n.atts),page:++E.dataset.page,player_id:s,nonce:n.nonce};Object.keys(i).forEach(function(e){t.searchParams.set(e,i[e])}),e.open("GET",t.toString(),!0),e.onload=function(){if(200===this.status){let e=JSON.parse(this.response);0<e.data.length?e.data.forEach(function(e){let t=function(e){function t(e){if(!e||"string"!=typeof e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function i(e){return!e||"string"!=typeof e||e.toLowerCase().startsWith("javascript:")?"":t(e)}let r=document.createElement("div");return r.innerHTML='<li class="playlist__item" data-episode="'+t(e.episode_id)+'"><div class="playlist__item__cover"><img src="'+i(e.album_art&&e.album_art.src?e.album_art.src:"")+'" title="'+t(e.title)+'" alt="'+t(e.title)+'" /></div><div class="playlist__item__details"><h2 class="playlist__episode-title" data-podcast="'+t(e.podcast_title)+'">'+t(e.title)+"</h2><p>"+t(e.date)+" â€¢ "+t(e.duration)+'</p><p class="playlist__episode-description">'+t(e.excerpt)+'</p></div><audio preload="none" class="clip clip-'+t(e.episode_id)+'"><source src="'+i(e.audio_file)+'"></audio></li>',r.firstChild}(e);L.appendChild(t),t.addEventListener("click",Z)}):E.removeEventListener("scroll",$)}r()},e.onerror=function(){r()},e.send()}()}K&&K.addEventListener("click",function(){return V(P)}),J&&J.addEventListener("click",function(){return V(P)}),N&&N.addEventListener("click",function(){return V(W)}),X&&X.addEventListener("click",function(){return V(W)}),G&&G.addEventListener("click",function(){return Y(B)}),z&&z.addEventListener("click",function(){return Y(U)}),Q&&Q.addEventListener("click",function(){return Y(I)}),document.addEventListener("keydown",e=>{if(document.activeElement.closest(".castos-player"))if("ArrowRight"===e.code)e.preventDefault(),r.currentTime+=30;else if("ArrowLeft"===e.code)e.preventDefault(),r.currentTime-=10;else if("Space"===e.code)e.preventDefault(),T();else if("m"===e.key||"M"===e.key)y.dispatchEvent(new Event("click")),y.focus();else if(e.shiftKey&&"Period"===e.code){let e=v.dataset.speed<2?parseFloat(v.dataset.speed)+.2:2;F(e.toFixed(1))}else if(e.shiftKey&&"Comma"===e.code){let e=.4<v.dataset.speed?parseFloat(v.dataset.speed)-.2:.4;F(e.toFixed(1))}else e.shiftKey&&"Digit0"===e.code&&F(1)}),S&&(q=E.querySelector(".loader"),function(){let e=L.querySelectorAll(".playlist__item");e&&e.forEach(function(e){e.addEventListener("click",Z)}),E&&E.addEventListener("scroll",$)}()),O()})});